<template>
  <div class="user-profile-tab">
    <div class="user-profile-block" >
      <h3 v-if="!galleryShow" class="user-profile-block__title">相册</h3>

      <div v-show="!galleryShow" class="user-profile-gallery">
        <div class="user-profile-gallery__item"
             @click="showGallery(gallery.images,gallery.title)"
             v-for="gallery in galleries"
             :style="'background: url('+gallery.image+') no-repeat center'"
             :class="{'galleryVIP':gallery.is_vip}">
          <svg v-show="gallery.is_vip" width="98" height="98" viewBox="0 0 98 98" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g style="mix-blend-mode:multiply" opacity="0.6">
              <circle cx="49" cy="49" r="49" fill="#383845"/>
            </g>
            <path d="M21.6172 56.6797C22.513 57.763 23.237 58.7161 23.7891 59.5391L21.9453 60.7578C21.2474 59.6432 20.5755 58.6536 19.9297 57.7891L21.6172 56.6797ZM34.1953 57.2422V59.0391L30.9453 60.8359H34.2109V67.5703C34.2109 68.0651 34.112 68.4557 33.9141 68.7422C33.7214 69.0286 33.4479 69.2161 33.0938 69.3047C32.7396 69.3932 31.9609 69.4297 30.7578 69.4141C30.6641 68.9453 30.5286 68.4089 30.3516 67.8047C30.8516 67.8359 31.263 67.8516 31.5859 67.8516C32.0234 67.8516 32.2422 67.6224 32.2422 67.1641V66.8984H30.1328V69.2422H28.2578V66.8984H26.2109V69.2578H24.2422V60.8359H27.2109L25.5234 59.7891L26.3203 58.8672H24.1172V57.2422H34.1953ZM31.4922 58.8672H26.8984C27.5443 59.237 28.2734 59.6667 29.0859 60.1562L31.4922 58.8672ZM32.2422 62.2422H30.1328V63.1953H32.2422V62.2422ZM26.2109 63.1953H28.2578V62.2422H26.2109V63.1953ZM30.1328 65.5234H32.2422V64.5703H30.1328V65.5234ZM26.2109 65.5234H28.2578V64.5703H26.2109V65.5234ZM35.1172 69.8359C34.7943 70.638 34.5391 71.3099 34.3516 71.8516L26.1328 71.7891C25.1589 71.763 24.3594 71.6172 23.7344 71.3516C23.1094 71.0911 22.5911 70.7266 22.1797 70.2578L20.4766 72.2109L19.5703 69.7891L21.0703 68.5078V64.2266H19.6797V62.1641H23.0234V68.5547C23.6432 69.4193 24.7474 69.8516 26.3359 69.8516L29.875 69.8984C31.4219 69.8984 33.1693 69.8776 35.1172 69.8359ZM43.1328 56.8672C43.7995 58.4609 44.4401 60.0859 45.0547 61.7422L42.8672 62.5547C42.3151 60.8568 41.6953 59.1797 41.0078 57.5234L43.1328 56.8672ZM48.3359 57.3516L50.5703 58.3672C49.5182 60.2318 48.4974 61.9974 47.5078 63.6641L45.5078 62.5703C46.5078 60.9245 47.4505 59.1849 48.3359 57.3516ZM38.3203 57.9922C39.1536 59.3672 39.9714 60.8099 40.7734 62.3203L38.6641 63.3516C38.0182 61.9661 37.2474 60.4818 36.3516 58.8984L38.3203 57.9922ZM35.8047 63.8047H50.8984V65.9766H35.8047V63.8047ZM46.1797 66.4453C48.0234 67.8411 49.6328 69.1797 51.0078 70.4609L49.2578 72.1328C47.737 70.612 46.2057 69.1849 44.6641 67.8516L46.1797 66.4453ZM40.1953 66.4766L41.9922 67.9297C40.4401 69.5859 38.8203 71.013 37.1328 72.2109L35.5547 70.4922C37.1901 69.4505 38.737 68.112 40.1953 66.4766ZM62.6875 57.8984L58.4844 70H55.5703L51.4219 57.8984H54.2031L56.8203 66.4531C56.9505 66.875 57.0312 67.2734 57.0625 67.6484H57.1094C57.151 67.263 57.2396 66.8542 57.375 66.4219L59.9922 57.8984H62.6875ZM66.7422 57.8984V70H64.1641V57.8984H66.7422ZM72.125 65.7812V70H69.5469V57.8984H73.7109C76.7214 57.8984 78.2266 59.1745 78.2266 61.7266C78.2266 62.9661 77.7708 63.9609 76.8594 64.7109C75.9531 65.4557 74.8177 65.8125 73.4531 65.7812H72.125ZM72.125 59.8984V63.8047H73.2422C74.7578 63.8047 75.5156 63.1458 75.5156 61.8281C75.5156 60.5417 74.7656 59.8984 73.2656 59.8984H72.125Z" fill="white"/>
            <path d="M49 37.5833C48.5801 37.5833 48.1774 37.7501 47.8804 38.0471C47.5835 38.344 47.4167 38.7467 47.4167 39.1667V43.9167C47.4167 44.3366 47.5835 44.7393 47.8804 45.0362C48.1774 45.3332 48.5801 45.5 49 45.5C49.4199 45.5 49.8227 45.3332 50.1196 45.0362C50.4165 44.7393 50.5833 44.3366 50.5833 43.9167V39.1667C50.5833 38.7467 50.4165 38.344 50.1196 38.0471C49.8227 37.7501 49.4199 37.5833 49 37.5833ZM56.9167 31.25H44.25V28.0833C44.2477 27.1431 44.5245 26.2234 45.0453 25.4406C45.566 24.6578 46.3074 24.0472 47.1755 23.686C48.0436 23.3249 48.9993 23.2295 49.9217 23.4119C50.844 23.5944 51.6914 24.0464 52.3567 24.7108C52.9519 25.3189 53.3777 26.0722 53.5917 26.8958C53.6437 27.0975 53.7349 27.287 53.8601 27.4534C53.9853 27.6199 54.142 27.76 54.3214 27.8659C54.5008 27.9717 54.6992 28.0412 54.9055 28.0704C55.1117 28.0996 55.3217 28.0878 55.5233 28.0358C55.725 27.9838 55.9145 27.8926 56.081 27.7674C56.2474 27.6422 56.3875 27.4855 56.4934 27.3061C56.5993 27.1267 56.6688 26.9283 56.6979 26.722C56.7271 26.5158 56.7153 26.3059 56.6633 26.1042C56.3026 24.7343 55.5872 23.4836 54.5892 22.4783C53.4811 21.3737 52.0706 20.6222 50.5358 20.3187C49.0009 20.0152 47.4106 20.1733 45.9655 20.773C44.5204 21.3727 43.2854 22.3872 42.4165 23.6883C41.5476 24.9894 41.0837 26.5188 41.0833 28.0833V31.25C39.8236 31.25 38.6154 31.7504 37.7246 32.6412C36.8338 33.532 36.3333 34.7402 36.3333 36V47.0833C36.3333 48.3431 36.8338 49.5513 37.7246 50.4421C38.6154 51.3329 39.8236 51.8333 41.0833 51.8333H56.9167C58.1765 51.8333 59.3846 51.3329 60.2754 50.4421C61.1662 49.5513 61.6667 48.3431 61.6667 47.0833V36C61.6667 34.7402 61.1662 33.532 60.2754 32.6412C59.3846 31.7504 58.1765 31.25 56.9167 31.25ZM58.5 47.0833C58.5 47.5033 58.3332 47.906 58.0363 48.2029C57.7393 48.4998 57.3366 48.6667 56.9167 48.6667H41.0833C40.6634 48.6667 40.2607 48.4998 39.9638 48.2029C39.6668 47.906 39.5 47.5033 39.5 47.0833V36C39.5 35.5801 39.6668 35.1773 39.9638 34.8804C40.2607 34.5835 40.6634 34.4167 41.0833 34.4167H56.9167C57.3366 34.4167 57.7393 34.5835 58.0363 34.8804C58.3332 35.1773 58.5 35.5801 58.5 36V47.0833Z" fill="white"/>
          </svg>
          <div v-show="gallery.images.length > 0" class="user-profile-gallery__item--number"><p>{{gallery.images.length}}</p></div>
          <div class="user-profile-gallery__item--title">
            <p>{{gallery.title}}</p>
            <p>{{gallery.subtitle}}</p>
          </div>
        </div>
      </div>

      <div v-show="galleryShow" class="user-profile-images">
        <div class="user-profile-images__top">
          <div class="user-profile-images__top--left">
            <h3 class="user-profile-block__title">相册 </h3>
            <svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 5L0.5 9.33013L0.5 0.669872L8 5Z" fill="#383845"/>
            </svg>
            <p>{{galleryTitle}}</p>
          </div>
          <div @click="galleryShow=false" class="user-profile-images__top--right">
            <svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M-2.18557e-07 5L7.5 0.669872L7.5 9.33013L-2.18557e-07 5Z" fill="#23D2E2"/>
            </svg>
            <p>返回专辑</p>
          </div>
        </div>
        <div class="user-profile-images__wrapper">
          <el-image v-for="(image,index) in imgList "
                    class="user-profile-images__item"
                    :key="index"
                    :src="image"
                    :preview-src-list="imgList">
          </el-image>
        </div>
      </div>

    </div>
  </div>
</template>

<script>
  export default {
    layout: 'girl_profile',
    scrollToTop: false,
    auth: false,
    async fetch({store,params}){
      await store.dispatch('girl_profile/fetchGirl',params.nickname)
    },
    async asyncData({$axios,params}){
      const response = await $axios.get(`/api/v1/gallery/get_galleries_by_user_nickname?nickname=${params.nickname}`)
      const galleries = response.data
      return {galleries}
    },
    data() {
      return {
        galleryTitle: null,
        imgList: [],
        galleryShow: false,
      }
    },
    methods: {
      showGallery(images,title){
        //показать все изображения в галерее из переданного массива images
        this.imgList =[]
        this.galleryTitle = title
        for (let i of images){
          this.imgList.push(i.image)
        }
        this.galleryShow = true
      }
    },

  }
</script>


<style>
         .fade-enter-active, .fade-leave-active {
            transition: all .5s ease-in-out;





         }
         .fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
            opacity: 0;
            /*transform :  scale(5);*/
         }
      </style>
